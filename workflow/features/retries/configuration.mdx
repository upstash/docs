---
title: "Configuration"
---

Both the number of retry attempts and the delay between retries are configurable in Workflow.

## Configuring Retry Count

Retry count is the number of times a step will be tried to execute again.

### In the `trigger()` function

When starting a workflow via `client.trigger`, you can set the number of retries for that workflow run:

<CodeGroup>
```typescript TypeScript
import { Client } from "@upstash/workflow";

const client = new Client({ token: "<WORKFLOW_TOKEN>" });

// Set retries for the workflow run
await client.trigger("my-workflow", { data: "example" }, { retries: 5 });
```

```python Python
from upstash_workflow import Client

client = Client("<WORKFLOW_TOKEN>")

# Set retries for the entire workflow run
await client.trigger("my-workflow", {"data": "example"}, retries=5)
```
</CodeGroup>

#### In the `serve()` function

Configure retries for all requests to a workflow endpoint (excluding workflow start and context.call requests):

<CodeGroup>
```typescript TypeScript
export const { POST } = serve<string>(
  async (context) => {
    // Your workflow logic...
  },
  {
    retries: 5
  }
);
```

```python Python
@serve.post("/api/example", retries=5)
async def example(context: AsyncWorkflowContext[str]) -> None:
    # Your workflow logic...
```
</CodeGroup>

## Configuring Retry Delays

You can configure custom retry delays using the `context.sleep` method to implement your own retry timing strategy:

<CodeGroup>
```typescript TypeScript
// Custom retry with fixed delays
for (let attempt = 0; attempt < 3; attempt++) {
  try {
    const result = await context.run("api-call", async () => {
      return await callExternalAPI();
    });
    return result;
  } catch (error) {
    if (attempt === 2) throw error;

    // Wait 30 seconds before next retry
    await context.sleep("wait-before-retry", 30);
  }
}
```

```python Python
# Custom retry with fixed delays
for attempt in range(3):
    try:
        async def _api_call():
            return await call_external_api()

        result = await context.run("api-call", _api_call)
        return result
    except Exception as error:
        if attempt == 2:
            raise error

        # Wait 30 seconds before next retry
        await context.sleep("wait-before-retry", 30)
```
</CodeGroup>

<Info>
    Upstash Workflow does not support step-level retry configuration.

    This means that retry configuration apply uniformly to all steps.
    You cannot configure retries or retry durations individually for a specific step.

    However, there are exceptions for external requests made via `context.call()` or `context.invoke()`.
    Since these represent calls to external endpoints, you can specify retries and custom retry behavior specifically for those steps, independently of the workflow-level retry settings.

    For more details on configuring retries for these steps, see the documentation for:
    - [context.call()]()
    - [context.invoke()]()
</Info>
