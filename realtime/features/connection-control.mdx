---
title: "Connection Control"
---

Enable or disable connections dynamically:

```typescript
"use client"

import { useState } from "react"
import { useRealtime } from "@upstash/realtime/client"
import type { RealtimeEvents } from "@/lib/realtime"

export default function Component() {
  const [enabled, setEnabled] = useState(true)

  const { status } = useRealtime<RealtimeEvents>({
    enabled,
    events: {
      notification: {
        alert: (data) => console.log(data),
      },
    },
  })

  return (
    <div>
      <button onClick={() => setEnabled(!enabled)}>
        {enabled ? "Disconnect" : "Connect"}
      </button>
      <p>Status: {status}</p>
    </div>
  )
}
```

## Connection States

The `status` value indicates the current connection state:

<ParamField path="connecting" type="string">
  Initial connection is being established
</ParamField>

<ParamField path="connected" type="string">
  Active connection, receiving events
</ParamField>

<ParamField path="reconnecting" type="string">
  Reconnecting after timeout or network interruption
</ParamField>

<ParamField path="disconnected" type="string">
  Connection closed (either by setting `enabled: false` or error)
</ParamField>

## Status-Based UI

Show connection status to users:

```typescript
"use client"

import { useRealtime } from "@upstash/realtime/client"

export default function StatusIndicator() {
  const { status } = useRealtime<RealtimeEvents>({
    events: { /* ... */ },
  })

  const getStatusColor = () => {
    switch (status) {
      case "connected":
        return "bg-green-500"
      case "connecting":
      case "reconnecting":
        return "bg-yellow-500"
      case "disconnected":
        return "bg-red-500"
      default:
        return "bg-gray-500"
    }
  }

  return (
    <div className="flex items-center gap-2">
      <div className={`w-2 h-2 rounded-full ${getStatusColor()}`} />
      <span className="text-sm capitalize">{status}</span>
    </div>
  )
}
```

## Best Practices

Establish a realtime connection only when needed:

```typescript
"use client"

import { useRealtime } from "@upstash/realtime/client"

export default function ConditionalConnection({ userId }: { userId?: string }) {
  useRealtime<RealtimeEvents>({
    enabled: !!userId,
    channel: userId ? `user-${userId}` : undefined,
    events: {
      notification: {
        alert: (data) => console.log(data),
      },
    },
  })

  return <div>Notifications {userId ? "enabled" : "disabled"}</div>
}
```
